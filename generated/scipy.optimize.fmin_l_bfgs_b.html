<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.optimize.fmin_l_bfgs_b &mdash; SciPy v1.1.0.dev0+4e64658 Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.0.dev0+4e64658',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.1.0.dev0+4e64658 Reference Guide" href="../index.html" >
    <link rel="up" title="Optimization and root finding (scipy.optimize)" href="../optimize.html" >
    <link rel="next" title="scipy.optimize.fmin_tnc" href="scipy.optimize.fmin_tnc.html" >
    <link rel="prev" title="scipy.optimize.fmin_ncg" href="scipy.optimize.fmin_ncg.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SciPy v1.1.0.dev0+4e64658 Reference Guide</a></li>
	
          <li class="active"><a href="../optimize.html" accesskey="U">Optimization and root finding (<code class="docutils literal"><span class="pre">scipy.optimize</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.optimize.fmin_tnc.html" title="scipy.optimize.fmin_tnc"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.optimize.fmin_ncg.html" title="scipy.optimize.fmin_ncg"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo">
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.optimize.fmin_ncg.html"
                        title="previous chapter">scipy.optimize.fmin_ncg</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.optimize.fmin_tnc.html"
                        title="next chapter">scipy.optimize.fmin_tnc</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-optimize-fmin-l-bfgs-b">
<h1>scipy.optimize.fmin_l_bfgs_b<a class="headerlink" href="#scipy-optimize-fmin-l-bfgs-b" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.optimize.fmin_l_bfgs_b">
<code class="descclassname">scipy.optimize.</code><code class="descname">fmin_l_bfgs_b</code><span class="sig-paren">(</span><em>func</em>, <em>x0</em>, <em>fprime=None</em>, <em>args=()</em>, <em>approx_grad=0</em>, <em>bounds=None</em>, <em>m=10</em>, <em>factr=10000000.0</em>, <em>pgtol=1e-05</em>, <em>epsilon=1e-08</em>, <em>iprint=-1</em>, <em>maxfun=15000</em>, <em>maxiter=15000</em>, <em>disp=None</em>, <em>callback=None</em>, <em>maxls=20</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/4e64658/scipy/optimize/lbfgsb.py#L49-L208"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.optimize.fmin_l_bfgs_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize a function func using the L-BFGS-B algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>func</strong> : callable f(x,*args)</p>
<blockquote>
<div><p>Function to minimise.</p>
</div></blockquote>
<p><strong>x0</strong> : ndarray</p>
<blockquote>
<div><p>Initial guess.</p>
</div></blockquote>
<p><strong>fprime</strong> : callable fprime(x,*args), optional</p>
<blockquote>
<div><p>The gradient of <em class="xref py py-obj">func</em>.  If None, then <em class="xref py py-obj">func</em> returns the function
value and the gradient (<code class="docutils literal"><span class="pre">f,</span> <span class="pre">g</span> <span class="pre">=</span> <span class="pre">func(x,</span> <span class="pre">*args)</span></code>), unless
<em class="xref py py-obj">approx_grad</em> is True in which case <em class="xref py py-obj">func</em> returns only <code class="docutils literal"><span class="pre">f</span></code>.</p>
</div></blockquote>
<p><strong>args</strong> : sequence, optional</p>
<blockquote>
<div><p>Arguments to pass to <em class="xref py py-obj">func</em> and <em class="xref py py-obj">fprime</em>.</p>
</div></blockquote>
<p><strong>approx_grad</strong> : bool, optional</p>
<blockquote>
<div><p>Whether to approximate the gradient numerically (in which case
<em class="xref py py-obj">func</em> returns only the function value).</p>
</div></blockquote>
<p><strong>bounds</strong> : list, optional</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">(min,</span> <span class="pre">max)</span></code> pairs for each element in <code class="docutils literal"><span class="pre">x</span></code>, defining
the bounds on that parameter. Use None or +-inf for one of <code class="docutils literal"><span class="pre">min</span></code> or
<code class="docutils literal"><span class="pre">max</span></code> when there is no bound in that direction.</p>
</div></blockquote>
<p><strong>m</strong> : int, optional</p>
<blockquote>
<div><p>The maximum number of variable metric corrections
used to define the limited memory matrix. (The limited memory BFGS
method does not store the full hessian but uses this many terms in an
approximation to it.)</p>
</div></blockquote>
<p><strong>factr</strong> : float, optional</p>
<blockquote>
<div><p>The iteration stops when
<code class="docutils literal"><span class="pre">(f^k</span> <span class="pre">-</span> <span class="pre">f^{k+1})/max{|f^k|,|f^{k+1}|,1}</span> <span class="pre">&lt;=</span> <span class="pre">factr</span> <span class="pre">*</span> <span class="pre">eps</span></code>,
where <code class="docutils literal"><span class="pre">eps</span></code> is the machine precision, which is automatically
generated by the code. Typical values for <em class="xref py py-obj">factr</em> are: 1e12 for
low accuracy; 1e7 for moderate accuracy; 10.0 for extremely
high accuracy. See Notes for relationship to <em class="xref py py-obj">ftol</em>, which is exposed
(instead of <em class="xref py py-obj">factr</em>) by the <a class="reference internal" href="scipy.optimize.minimize.html#scipy.optimize.minimize" title="scipy.optimize.minimize"><code class="xref py py-obj docutils literal"><span class="pre">scipy.optimize.minimize</span></code></a> interface to
L-BFGS-B.</p>
</div></blockquote>
<p><strong>pgtol</strong> : float, optional</p>
<blockquote>
<div><p>The iteration will stop when
<code class="docutils literal"><span class="pre">max{|proj</span> <span class="pre">g_i</span> <span class="pre">|</span> <span class="pre">i</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">n}</span> <span class="pre">&lt;=</span> <span class="pre">pgtol</span></code>
where <code class="docutils literal"><span class="pre">pg_i</span></code> is the i-th component of the projected gradient.</p>
</div></blockquote>
<p><strong>epsilon</strong> : float, optional</p>
<blockquote>
<div><p>Step size used when <em class="xref py py-obj">approx_grad</em> is True, for numerically
calculating the gradient</p>
</div></blockquote>
<p><strong>iprint</strong> : int, optional</p>
<blockquote>
<div><p>Controls the frequency of output. <code class="docutils literal"><span class="pre">iprint</span> <span class="pre">&lt;</span> <span class="pre">0</span></code> means no output;
<code class="docutils literal"><span class="pre">iprint</span> <span class="pre">=</span> <span class="pre">0</span></code>    print only one line at the last iteration;
<code class="docutils literal"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">iprint</span> <span class="pre">&lt;</span> <span class="pre">99</span></code> print also f and <code class="docutils literal"><span class="pre">|proj</span> <span class="pre">g|</span></code> every iprint iterations;
<code class="docutils literal"><span class="pre">iprint</span> <span class="pre">=</span> <span class="pre">99</span></code>   print details of every iteration except n-vectors;
<code class="docutils literal"><span class="pre">iprint</span> <span class="pre">=</span> <span class="pre">100</span></code>  print also the changes of active set and final x;
<code class="docutils literal"><span class="pre">iprint</span> <span class="pre">&gt;</span> <span class="pre">100</span></code>  print details of every iteration including x and g.</p>
</div></blockquote>
<p><strong>disp</strong> : int, optional</p>
<blockquote>
<div><p>If zero, then no output.  If a positive number, then this over-rides
<em class="xref py py-obj">iprint</em> (i.e., <em class="xref py py-obj">iprint</em> gets the value of <em class="xref py py-obj">disp</em>).</p>
</div></blockquote>
<p><strong>maxfun</strong> : int, optional</p>
<blockquote>
<div><p>Maximum number of function evaluations.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int, optional</p>
<blockquote>
<div><p>Maximum number of iterations.</p>
</div></blockquote>
<p><strong>callback</strong> : callable, optional</p>
<blockquote>
<div><p>Called after each iteration, as <code class="docutils literal"><span class="pre">callback(xk)</span></code>, where <code class="docutils literal"><span class="pre">xk</span></code> is the
current parameter vector.</p>
</div></blockquote>
<p><strong>maxls</strong> : int, optional</p>
<blockquote>
<div><p>Maximum number of line search steps (per iteration). Default is 20.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x</strong> : array_like</p>
<blockquote>
<div><p>Estimated position of the minimum.</p>
</div></blockquote>
<p><strong>f</strong> : float</p>
<blockquote>
<div><p>Value of <em class="xref py py-obj">func</em> at the minimum.</p>
</div></blockquote>
<p><strong>d</strong> : dict</p>
<blockquote class="last">
<div><p>Information dictionary.</p>
<ul class="simple">
<li>d[‘warnflag’] is<ul>
<li>0 if converged,</li>
<li>1 if too many function evaluations or too many iterations,</li>
<li>2 if stopped for another reason, given in d[‘task’]</li>
</ul>
</li>
<li>d[‘grad’] is the gradient at the minimum (should be 0 ish)</li>
<li>d[‘funcalls’] is the number of function calls made.</li>
<li>d[‘nit’] is the number of iterations.</li>
</ul>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="scipy.optimize.minimize.html#scipy.optimize.minimize" title="scipy.optimize.minimize"><code class="xref py py-obj docutils literal"><span class="pre">minimize</span></code></a></dt>
<dd>Interface to minimization algorithms for multivariate functions. See the ‘L-BFGS-B’ <em class="xref py py-obj">method</em> in particular. Note that the <em class="xref py py-obj">ftol</em> option is made available via that interface, while <em class="xref py py-obj">factr</em> is provided via this interface, where <em class="xref py py-obj">factr</em> is the factor multiplying the default machine floating-point precision to arrive at <em class="xref py py-obj">ftol</em>: <code class="docutils literal"><span class="pre">ftol</span> <span class="pre">=</span> <span class="pre">factr</span> <span class="pre">*</span> <span class="pre">numpy.finfo(float).eps</span></code>.</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>License of L-BFGS-B (FORTRAN code):</p>
<p>The version included here (in fortran code) is 3.0
(released April 25, 2011).  It was written by Ciyou Zhu, Richard Byrd,
and Jorge Nocedal &lt;<a class="reference external" href="mailto:nocedal&#37;&#52;&#48;ece&#46;nwu&#46;edu">nocedal<span>&#64;</span>ece<span>&#46;</span>nwu<span>&#46;</span>edu</a>&gt;. It carries the following
condition for use:</p>
<p>This software is freely available, but we expect that all publications
describing work using this software, or all commercial products using it,
quote at least one of the references given below. This software is released
under the BSD License.</p>
<p class="rubric">References</p>
<ul class="simple">
<li>R. H. Byrd, P. Lu and J. Nocedal. A Limited Memory Algorithm for Bound
Constrained Optimization, (1995), SIAM Journal on Scientific and
Statistical Computing, 16, 5, pp. 1190-1208.</li>
<li>C. Zhu, R. H. Byrd and J. Nocedal. L-BFGS-B: Algorithm 778: L-BFGS-B,
FORTRAN routines for large scale bound constrained optimization (1997),
ACM Transactions on Mathematical Software, 23, 4, pp. 550 - 560.</li>
<li>J.L. Morales and J. Nocedal. L-BFGS-B: Remark on Algorithm 778: L-BFGS-B,
FORTRAN routines for large scale bound constrained optimization (2011),
ACM Transactions on Mathematical Software, 38, 1.</li>
</ul>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2016, The Scipy community.
      </li>
      <li>
      Last updated on Sep 21, 2017.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>