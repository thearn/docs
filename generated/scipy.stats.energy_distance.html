<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.stats.energy_distance &mdash; SciPy v1.1.0.dev0+4e64658 Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.0.dev0+4e64658',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.1.0.dev0+4e64658 Reference Guide" href="../index.html" >
    <link rel="up" title="Statistical functions (scipy.stats)" href="../stats.html" >
    <link rel="next" title="scipy.stats.circmean" href="scipy.stats.circmean.html" >
    <link rel="prev" title="scipy.stats.wasserstein_distance" href="scipy.stats.wasserstein_distance.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SciPy v1.1.0.dev0+4e64658 Reference Guide</a></li>
	
          <li class="active"><a href="../stats.html" accesskey="U">Statistical functions (<code class="docutils literal"><span class="pre">scipy.stats</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.stats.circmean.html" title="scipy.stats.circmean"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.stats.wasserstein_distance.html" title="scipy.stats.wasserstein_distance"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo">
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.stats.wasserstein_distance.html"
                        title="previous chapter">scipy.stats.wasserstein_distance</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.stats.circmean.html"
                        title="next chapter">scipy.stats.circmean</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-stats-energy-distance">
<h1>scipy.stats.energy_distance<a class="headerlink" href="#scipy-stats-energy-distance" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.stats.energy_distance">
<code class="descclassname">scipy.stats.</code><code class="descname">energy_distance</code><span class="sig-paren">(</span><em>u_values</em>, <em>v_values</em>, <em>u_weights=None</em>, <em>v_weights=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/4e64658/scipy/stats/stats.py#L5324-L5403"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.stats.energy_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the energy distance between two 1D distributions.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.0.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>u_values, v_values</strong> : array_like</p>
<blockquote>
<div><p>Values observed in the (empirical) distribution.</p>
</div></blockquote>
<p><strong>u_weights, v_weights</strong> : array_like, optional</p>
<blockquote>
<div><p>Weight for each value. If unspecified, each value is assigned the same
weight.
<em class="xref py py-obj">u_weights</em> (resp. <em class="xref py py-obj">v_weights</em>) must have the same length as
<em class="xref py py-obj">u_values</em> (resp. <em class="xref py py-obj">v_values</em>). If the weight sum differs from 1, it
must still be positive and finite so that the weights can be normalized
to sum to 1.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>distance</strong> : float</p>
<blockquote class="last">
<div><p>The computed distance between the distributions.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The energy distance between two distributions <span class="math">\(u\)</span> and <span class="math">\(v\)</span>, whose
respective CDFs are <span class="math">\(U\)</span> and <span class="math">\(V\)</span>, equals to:</p>
<div class="math">
\[D(u, v) = \left( 2\mathbb E|X - Y| - \mathbb E|X - X'| -
\mathbb E|Y - Y'| \right)^{1/2}\]</div>
<p>where <span class="math">\(X\)</span> and <span class="math">\(X'\)</span> (resp. <span class="math">\(Y\)</span> and <span class="math">\(Y'\)</span>) are
independent random variables whose probability distribution is <span class="math">\(u\)</span>
(resp. <span class="math">\(v\)</span>).</p>
<p>As shown in <a class="reference internal" href="#r597" id="id1">[R597]</a>, for one-dimensional real-valued variables, the energy
distance is linked to the non-distribution-free version of the Cramer-von
Mises distance:</p>
<div class="math">
\[D(u, v) = \sqrt{2} l_2(u, v) = \left( 2 \int_{-\infty}^{+\infty} (U-V)^2
\right)^{1/2}\]</div>
<p>Note that the common Cramer-von Mises criterion uses the distribution-free
version of the distance. See <a class="reference internal" href="#r597" id="id2">[R597]</a> (section 2), for more details about both
versions of the distance.</p>
<p>The input distributions can be empirical, therefore coming from samples
whose values are effectively inputs of the function, or they can be seen as
generalized functions, in which case they are weighted sums of Dirac delta
functions located at the specified values.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r596" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[R596]</a></td><td>“Energy distance”, <a class="reference external" href="https://en.wikipedia.org/wiki/Energy_distance">https://en.wikipedia.org/wiki/Energy_distance</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r597" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R597]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id4">3</a>)</em> Szekely “E-statistics: The energy of statistical samples.” Bowling
Green State University, Department of Mathematics and Statistics,
Technical Report 02-16 (2002).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r598" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[R598]</a></td><td>Rizzo, Szekely “Energy distance.” Wiley Interdisciplinary Reviews:
Computational Statistics, 8(1):27-38 (2015).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r599" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[R599]</a></td><td>Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer,
Munos “The Cramer Distance as a Solution to Biased Wasserstein
Gradients” (2017). <a class="reference external" href="https://arxiv.org/abs/1705.10743">arXiv:1705.10743</a>.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">energy_distance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">energy_distance</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">2.0000000000000004</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">energy_distance</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">1.0000000000000002</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">energy_distance</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">8.</span> <span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="mf">8.</span> <span class="p">],</span> <span class="p">[</span><span class="mf">7.6</span><span class="p">,</span> <span class="mf">8.8</span><span class="p">])</span>
<span class="go">0.88003340976158217</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2016, The Scipy community.
      </li>
      <li>
      Last updated on Sep 21, 2017.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>