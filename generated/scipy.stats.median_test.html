<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.stats.median_test &mdash; SciPy v1.1.0.dev0+4e64658 Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.0.dev0+4e64658',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.1.0.dev0+4e64658 Reference Guide" href="../index.html" >
    <link rel="up" title="Statistical functions (scipy.stats)" href="../stats.html" >
    <link rel="next" title="scipy.stats.mood" href="scipy.stats.mood.html" >
    <link rel="prev" title="scipy.stats.fligner" href="scipy.stats.fligner.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SciPy v1.1.0.dev0+4e64658 Reference Guide</a></li>
	
          <li class="active"><a href="../stats.html" accesskey="U">Statistical functions (<code class="docutils literal"><span class="pre">scipy.stats</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.stats.mood.html" title="scipy.stats.mood"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.stats.fligner.html" title="scipy.stats.fligner"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo">
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.stats.fligner.html"
                        title="previous chapter">scipy.stats.fligner</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.stats.mood.html"
                        title="next chapter">scipy.stats.mood</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-stats-median-test">
<h1>scipy.stats.median_test<a class="headerlink" href="#scipy-stats-median-test" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.stats.median_test">
<code class="descclassname">scipy.stats.</code><code class="descname">median_test</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/4e64658/scipy/stats/morestats.py#L2416-L2638"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.stats.median_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Mood’s median test.</p>
<p>Test that two or more samples come from populations with the same median.</p>
<p>Let <code class="docutils literal"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">len(args)</span></code> be the number of samples.  The “grand median” of
all the data is computed, and a contingency table is formed by
classifying the values in each sample as being above or below the grand
median.  The contingency table, along with <em class="xref py py-obj">correction</em> and <em class="xref py py-obj">lambda_</em>,
are passed to <a class="reference internal" href="scipy.stats.chi2_contingency.html#scipy.stats.chi2_contingency" title="scipy.stats.chi2_contingency"><code class="xref py py-obj docutils literal"><span class="pre">scipy.stats.chi2_contingency</span></code></a> to compute the test statistic
and p-value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>sample1, sample2, …</strong> : array_like</p>
<blockquote>
<div><p>The set of samples.  There must be at least two samples.
Each sample must be a one-dimensional sequence containing at least
one value.  The samples are not required to have the same length.</p>
</div></blockquote>
<p><strong>ties</strong> : str, optional</p>
<blockquote>
<div><p>Determines how values equal to the grand median are classified in
the contingency table.  The string must be one of:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot;below&quot;</span><span class="p">:</span>
    <span class="n">Values</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">the</span> <span class="n">grand</span> <span class="n">median</span> <span class="n">are</span> <span class="n">counted</span> <span class="k">as</span> <span class="s2">&quot;below&quot;</span><span class="o">.</span>
<span class="s2">&quot;above&quot;</span><span class="p">:</span>
    <span class="n">Values</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">the</span> <span class="n">grand</span> <span class="n">median</span> <span class="n">are</span> <span class="n">counted</span> <span class="k">as</span> <span class="s2">&quot;above&quot;</span><span class="o">.</span>
<span class="s2">&quot;ignore&quot;</span><span class="p">:</span>
    <span class="n">Values</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">the</span> <span class="n">grand</span> <span class="n">median</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">counted</span><span class="o">.</span>
</pre></div>
</div>
<p>The default is “below”.</p>
</div></blockquote>
<p><strong>correction</strong> : bool, optional</p>
<blockquote>
<div><p>If True, <em>and</em> there are just two samples, apply Yates’ correction
for continuity when computing the test statistic associated with
the contingency table.  Default is True.</p>
</div></blockquote>
<p><strong>lambda_</strong> : float or str, optional.</p>
<blockquote>
<div><p>By default, the statistic computed in this test is Pearson’s
chi-squared statistic.  <em class="xref py py-obj">lambda_</em> allows a statistic from the
Cressie-Read power divergence family to be used instead.  See
<a class="reference internal" href="scipy.stats.power_divergence.html#scipy.stats.power_divergence" title="scipy.stats.power_divergence"><code class="xref py py-obj docutils literal"><span class="pre">power_divergence</span></code></a> for details.
Default is 1 (Pearson’s chi-squared statistic).</p>
</div></blockquote>
<p><strong>nan_policy</strong> : {‘propagate’, ‘raise’, ‘omit’}, optional</p>
<blockquote>
<div><p>Defines how to handle when input contains nan. ‘propagate’ returns nan,
‘raise’ throws an error, ‘omit’ performs the calculations ignoring nan
values. Default is ‘propagate’.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>stat</strong> : float</p>
<blockquote>
<div><p>The test statistic.  The statistic that is returned is determined by
<em class="xref py py-obj">lambda_</em>.  The default is Pearson’s chi-squared statistic.</p>
</div></blockquote>
<p><strong>p</strong> : float</p>
<blockquote>
<div><p>The p-value of the test.</p>
</div></blockquote>
<p><strong>m</strong> : float</p>
<blockquote>
<div><p>The grand median.</p>
</div></blockquote>
<p><strong>table</strong> : ndarray</p>
<blockquote class="last">
<div><p>The contingency table.  The shape of the table is (2, n), where
n is the number of samples.  The first row holds the counts of the
values above the grand median, and the second row holds the counts
of the values below the grand median.  The table allows further
analysis with, for example, <a class="reference internal" href="scipy.stats.chi2_contingency.html#scipy.stats.chi2_contingency" title="scipy.stats.chi2_contingency"><code class="xref py py-obj docutils literal"><span class="pre">scipy.stats.chi2_contingency</span></code></a>, or with
<a class="reference internal" href="scipy.stats.fisher_exact.html#scipy.stats.fisher_exact" title="scipy.stats.fisher_exact"><code class="xref py py-obj docutils literal"><span class="pre">scipy.stats.fisher_exact</span></code></a> if there are two samples, without having
to recompute the table.  If <code class="docutils literal"><span class="pre">nan_policy</span></code> is “propagate” and there
are nans in the input, the return value for <code class="docutils literal"><span class="pre">table</span></code> is <code class="docutils literal"><span class="pre">None</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="scipy.stats.kruskal.html#scipy.stats.kruskal" title="scipy.stats.kruskal"><code class="xref py py-obj docutils literal"><span class="pre">kruskal</span></code></a></dt>
<dd>Compute the Kruskal-Wallis H-test for independent samples.</dd>
<dt><a class="reference internal" href="scipy.stats.mannwhitneyu.html#scipy.stats.mannwhitneyu" title="scipy.stats.mannwhitneyu"><code class="xref py py-obj docutils literal"><span class="pre">mannwhitneyu</span></code></a></dt>
<dd>Computes the Mann-Whitney rank test on samples x and y.</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.15.0.</span></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r635" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R635]</a></td><td>Mood, A. M., Introduction to the Theory of Statistics. McGraw-Hill
(1950), pp. 394-399.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r636" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[R636]</a></td><td>Zar, J. H., Biostatistical Analysis, 5th ed. Prentice Hall (2010).
See Sections 8.12 and 10.15.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>A biologist runs an experiment in which there are three groups of plants.
Group 1 has 16 plants, group 2 has 15 plants, and group 3 has 17 plants.
Each plant produces a number of seeds.  The seed counts for each group
are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Group</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">10</span> <span class="mi">14</span> <span class="mi">14</span> <span class="mi">18</span> <span class="mi">20</span> <span class="mi">22</span> <span class="mi">24</span> <span class="mi">25</span> <span class="mi">31</span> <span class="mi">31</span> <span class="mi">32</span> <span class="mi">39</span> <span class="mi">43</span> <span class="mi">43</span> <span class="mi">48</span> <span class="mi">49</span>
<span class="n">Group</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">28</span> <span class="mi">30</span> <span class="mi">31</span> <span class="mi">33</span> <span class="mi">34</span> <span class="mi">35</span> <span class="mi">36</span> <span class="mi">40</span> <span class="mi">44</span> <span class="mi">55</span> <span class="mi">57</span> <span class="mi">61</span> <span class="mi">91</span> <span class="mi">92</span> <span class="mi">99</span>
<span class="n">Group</span> <span class="mi">3</span><span class="p">:</span>  <span class="mi">0</span>  <span class="mi">3</span>  <span class="mi">9</span> <span class="mi">22</span> <span class="mi">23</span> <span class="mi">25</span> <span class="mi">25</span> <span class="mi">33</span> <span class="mi">34</span> <span class="mi">34</span> <span class="mi">40</span> <span class="mi">45</span> <span class="mi">46</span> <span class="mi">48</span> <span class="mi">62</span> <span class="mi">67</span> <span class="mi">84</span>
</pre></div>
</div>
<p>The following code applies Mood’s median test to these samples.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">99</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">84</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">median_test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">med</span><span class="p">,</span> <span class="n">tbl</span> <span class="o">=</span> <span class="n">median_test</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g3</span><span class="p">)</span>
</pre></div>
</div>
<p>The median is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">med</span>
<span class="go">34.0</span>
</pre></div>
</div>
<p>and the contingency table is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tbl</span>
<span class="go">array([[ 5, 10,  7],</span>
<span class="go">       [11,  5, 10]])</span>
</pre></div>
</div>
<p><em class="xref py py-obj">p</em> is too large to conclude that the medians are not the same:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">0.12609082774093244</span>
</pre></div>
</div>
<p>The “G-test” can be performed by passing <code class="docutils literal"><span class="pre">lambda_=&quot;log-likelihood&quot;</span></code> to
<a class="reference internal" href="#scipy.stats.median_test" title="scipy.stats.median_test"><code class="xref py py-obj docutils literal"><span class="pre">median_test</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">med</span><span class="p">,</span> <span class="n">tbl</span> <span class="o">=</span> <span class="n">median_test</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g3</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="s2">&quot;log-likelihood&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">0.12224779737117837</span>
</pre></div>
</div>
<p>The median occurs several times in the data, so we’ll get a different
result if, for example, <code class="docutils literal"><span class="pre">ties=&quot;above&quot;</span></code> is used:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">med</span><span class="p">,</span> <span class="n">tbl</span> <span class="o">=</span> <span class="n">median_test</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g3</span><span class="p">,</span> <span class="n">ties</span><span class="o">=</span><span class="s2">&quot;above&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">0.063873276069553273</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tbl</span>
<span class="go">array([[ 5, 11,  9],</span>
<span class="go">       [11,  4,  8]])</span>
</pre></div>
</div>
<p>This example demonstrates that if the data set is not large and there
are values equal to the median, the p-value can be sensitive to the
choice of <em class="xref py py-obj">ties</em>.</p>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2016, The Scipy community.
      </li>
      <li>
      Last updated on Sep 21, 2017.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>