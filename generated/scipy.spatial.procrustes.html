<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.spatial.procrustes &mdash; SciPy v1.1.0.dev0+4e64658 Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.0.dev0+4e64658',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.1.0.dev0+4e64658 Reference Guide" href="../index.html" >
    <link rel="up" title="Spatial algorithms and data structures (scipy.spatial)" href="../spatial.html" >
    <link rel="next" title="Distance computations (scipy.spatial.distance)" href="../spatial.distance.html" >
    <link rel="prev" title="scipy.spatial.minkowski_distance_p" href="scipy.spatial.minkowski_distance_p.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SciPy v1.1.0.dev0+4e64658 Reference Guide</a></li>
	
          <li class="active"><a href="../spatial.html" accesskey="U">Spatial algorithms and data structures (<code class="docutils literal"><span class="pre">scipy.spatial</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="../spatial.distance.html" title="Distance computations (scipy.spatial.distance)"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.spatial.minkowski_distance_p.html" title="scipy.spatial.minkowski_distance_p"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo">
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.spatial.minkowski_distance_p.html"
                        title="previous chapter">scipy.spatial.minkowski_distance_p</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../spatial.distance.html"
                        title="next chapter">Distance computations (<code class="docutils literal"><span class="pre">scipy.spatial.distance</span></code>)</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-spatial-procrustes">
<h1>scipy.spatial.procrustes<a class="headerlink" href="#scipy-spatial-procrustes" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.spatial.procrustes">
<code class="descclassname">scipy.spatial.</code><code class="descname">procrustes</code><span class="sig-paren">(</span><em>data1</em>, <em>data2</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/4e64658/scipy/spatial/_procrustes.py#L17-L132"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.spatial.procrustes" title="Permalink to this definition">¶</a></dt>
<dd><p>Procrustes analysis, a similarity test for two data sets.</p>
<p>Each input matrix is a set of points or vectors (the rows of the matrix).
The dimension of the space is the number of columns of each matrix. Given
two identically sized matrices, procrustes standardizes both such that:</p>
<ul class="simple">
<li><span class="math">\(tr(AA^{T}) = 1\)</span>.</li>
<li>Both sets of points are centered around the origin.</li>
</ul>
<p>Procrustes (<a class="reference internal" href="#r377" id="id1">[R377]</a>, <a class="reference internal" href="#r378" id="id2">[R378]</a>) then applies the optimal transform to the second
matrix (including scaling/dilation, rotations, and reflections) to minimize
<span class="math">\(M^{2}=\sum(data1-data2)^{2}\)</span>, or the sum of the squares of the
pointwise differences between the two input datasets.</p>
<p>This function was not designed to handle datasets with different numbers of
datapoints (rows).  If two data sets have different dimensionality
(different number of columns), simply add columns of zeros to the smaller
of the two.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data1</strong> : array_like</p>
<blockquote>
<div><p>Matrix, n rows represent points in k (columns) space <em class="xref py py-obj">data1</em> is the
reference data, after it is standardised, the data from <em class="xref py py-obj">data2</em> will be
transformed to fit the pattern in <em class="xref py py-obj">data1</em> (must have &gt;1 unique points).</p>
</div></blockquote>
<p><strong>data2</strong> : array_like</p>
<blockquote>
<div><p>n rows of data in k space to be fit to <em class="xref py py-obj">data1</em>.  Must be the  same
shape <code class="docutils literal"><span class="pre">(numrows,</span> <span class="pre">numcols)</span></code> as data1 (must have &gt;1 unique points).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mtx1</strong> : array_like</p>
<blockquote>
<div><p>A standardized version of <em class="xref py py-obj">data1</em>.</p>
</div></blockquote>
<p><strong>mtx2</strong> : array_like</p>
<blockquote>
<div><p>The orientation of <em class="xref py py-obj">data2</em> that best fits <em class="xref py py-obj">data1</em>. Centered, but not
necessarily <span class="math">\(tr(AA^{T}) = 1\)</span>.</p>
</div></blockquote>
<p><strong>disparity</strong> : float</p>
<blockquote>
<div><p><span class="math">\(M^{2}\)</span> as defined above.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>If the input arrays are not two-dimensional.
If the shape of the input arrays is different.
If the input arrays have zero columns or zero rows.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p><a class="reference internal" href="scipy.linalg.orthogonal_procrustes.html#scipy.linalg.orthogonal_procrustes" title="scipy.linalg.orthogonal_procrustes"><code class="xref py py-obj docutils literal"><span class="pre">scipy.linalg.orthogonal_procrustes</span></code></a></p>
<dl class="last docutils">
<dt><a class="reference internal" href="scipy.spatial.distance.directed_hausdorff.html#scipy.spatial.distance.directed_hausdorff" title="scipy.spatial.distance.directed_hausdorff"><code class="xref py py-obj docutils literal"><span class="pre">scipy.spatial.distance.directed_hausdorff</span></code></a></dt>
<dd>Another similarity test for two data sets</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li>The disparity should not depend on the order of the input matrices, but
the output matrices will, as only the first output matrix is guaranteed
to be scaled such that <span class="math">\(tr(AA^{T}) = 1\)</span>.</li>
<li>Duplicate data points are generally ok, duplicating a data point will
increase its effect on the procrustes fit.</li>
<li>The disparity scales as the number of points per input matrix.</li>
</ul>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r377" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R377]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id3">2</a>)</em> Krzanowski, W. J. (2000). “Principles of Multivariate analysis”.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r378" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R378]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> Gower, J. C. (1975). “Generalized procrustes analysis”.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="k">import</span> <span class="n">procrustes</span>
</pre></div>
</div>
<p>The matrix <code class="docutils literal"><span class="pre">b</span></code> is a rotated, shifted, scaled and mirrored version of
<code class="docutils literal"><span class="pre">a</span></code> here:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">]],</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mtx1</span><span class="p">,</span> <span class="n">mtx2</span><span class="p">,</span> <span class="n">disparity</span> <span class="o">=</span> <span class="n">procrustes</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">disparity</span><span class="p">)</span>
<span class="go">0.0</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2016, The Scipy community.
      </li>
      <li>
      Last updated on Sep 21, 2017.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>