<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.signal.stft &mdash; SciPy v1.1.0.dev0+04759f9 Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.0.dev0+04759f9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.1.0.dev0+04759f9 Reference Guide" href="../index.html" >
    <link rel="up" title="Signal processing (scipy.signal)" href="../signal.html" >
    <link rel="next" title="scipy.signal.istft" href="scipy.signal.istft.html" >
    <link rel="prev" title="scipy.signal.vectorstrength" href="scipy.signal.vectorstrength.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SciPy v1.1.0.dev0+04759f9 Reference Guide</a></li>
	
          <li class="active"><a href="../signal.html" accesskey="U">Signal processing (<code class="docutils literal"><span class="pre">scipy.signal</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.signal.istft.html" title="scipy.signal.istft"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.signal.vectorstrength.html" title="scipy.signal.vectorstrength"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo">
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.signal.vectorstrength.html"
                        title="previous chapter">scipy.signal.vectorstrength</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.signal.istft.html"
                        title="next chapter">scipy.signal.istft</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-signal-stft">
<h1>scipy.signal.stft<a class="headerlink" href="#scipy-signal-stft" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.signal.stft">
<code class="descclassname">scipy.signal.</code><code class="descname">stft</code><span class="sig-paren">(</span><em>x</em>, <em>fs=1.0</em>, <em>window='hann'</em>, <em>nperseg=256</em>, <em>noverlap=None</em>, <em>nfft=None</em>, <em>detrend=False</em>, <em>return_onesided=True</em>, <em>boundary='zeros'</em>, <em>padded=True</em>, <em>axis=-1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/04759f9/scipy/signal/spectral.py#L848-L992"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.signal.stft" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Short Time Fourier Transform (STFT).</p>
<p>STFTs can be used as a way of quantifying the change of a
nonstationary signal’s frequency and phase content over time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array_like</p>
<blockquote>
<div><p>Time series of measurement values</p>
</div></blockquote>
<p><strong>fs</strong> : float, optional</p>
<blockquote>
<div><p>Sampling frequency of the <em class="xref py py-obj">x</em> time series. Defaults to 1.0.</p>
</div></blockquote>
<p><strong>window</strong> : str or tuple or array_like, optional</p>
<blockquote>
<div><p>Desired window to use. If <em class="xref py py-obj">window</em> is a string or tuple, it is
passed to <a class="reference internal" href="scipy.signal.get_window.html#scipy.signal.get_window" title="scipy.signal.get_window"><code class="xref py py-obj docutils literal"><span class="pre">get_window</span></code></a> to generate the window values, which are
DFT-even by default. See <a class="reference internal" href="scipy.signal.get_window.html#scipy.signal.get_window" title="scipy.signal.get_window"><code class="xref py py-obj docutils literal"><span class="pre">get_window</span></code></a> for a list of windows and
required parameters. If <em class="xref py py-obj">window</em> is array_like it will be used
directly as the window and its length must be nperseg. Defaults
to a Hann window.</p>
</div></blockquote>
<p><strong>nperseg</strong> : int, optional</p>
<blockquote>
<div><p>Length of each segment. Defaults to 256.</p>
</div></blockquote>
<p><strong>noverlap</strong> : int, optional</p>
<blockquote>
<div><p>Number of points to overlap between segments. If <em class="xref py py-obj">None</em>,
<code class="docutils literal"><span class="pre">noverlap</span> <span class="pre">=</span> <span class="pre">nperseg</span> <span class="pre">//</span> <span class="pre">2</span></code>. Defaults to <em class="xref py py-obj">None</em>. When
specified, the COLA constraint must be met (see Notes below).</p>
</div></blockquote>
<p><strong>nfft</strong> : int, optional</p>
<blockquote>
<div><p>Length of the FFT used, if a zero padded FFT is desired. If
<em class="xref py py-obj">None</em>, the FFT length is <em class="xref py py-obj">nperseg</em>. Defaults to <em class="xref py py-obj">None</em>.</p>
</div></blockquote>
<p><strong>detrend</strong> : str or function or <em class="xref py py-obj">False</em>, optional</p>
<blockquote>
<div><p>Specifies how to detrend each segment. If <a class="reference internal" href="scipy.signal.detrend.html#scipy.signal.detrend" title="scipy.signal.detrend"><code class="xref py py-obj docutils literal"><span class="pre">detrend</span></code></a> is a
string, it is passed as the <em class="xref py py-obj">type</em> argument to the <a class="reference internal" href="scipy.signal.detrend.html#scipy.signal.detrend" title="scipy.signal.detrend"><code class="xref py py-obj docutils literal"><span class="pre">detrend</span></code></a>
function. If it is a function, it takes a segment and returns a
detrended segment. If <a class="reference internal" href="scipy.signal.detrend.html#scipy.signal.detrend" title="scipy.signal.detrend"><code class="xref py py-obj docutils literal"><span class="pre">detrend</span></code></a> is <em class="xref py py-obj">False</em>, no detrending is
done. Defaults to <em class="xref py py-obj">False</em>.</p>
</div></blockquote>
<p><strong>return_onesided</strong> : bool, optional</p>
<blockquote>
<div><p>If <em class="xref py py-obj">True</em>, return a one-sided spectrum for real data. If
<em class="xref py py-obj">False</em> return a two-sided spectrum. Note that for complex
data, a two-sided spectrum is always returned. Defaults to
<em class="xref py py-obj">True</em>.</p>
</div></blockquote>
<p><strong>boundary</strong> : str or None, optional</p>
<blockquote>
<div><p>Specifies whether the input signal is extended at both ends, and
how to generate the new values, in order to center the first
windowed segment on the first input point. This has the benefit
of enabling reconstruction of the first input point when the
employed window function starts at zero. Valid options are
<code class="docutils literal"><span class="pre">['even',</span> <span class="pre">'odd',</span> <span class="pre">'constant',</span> <span class="pre">'zeros',</span> <span class="pre">None]</span></code>. Defaults to
‘zeros’, for zero padding extension. I.e. <code class="docutils literal"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4]</span></code> is
extended to <code class="docutils literal"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">0]</span></code> for <code class="docutils literal"><span class="pre">nperseg=3</span></code>.</p>
</div></blockquote>
<p><strong>padded</strong> : bool, optional</p>
<blockquote>
<div><p>Specifies whether the input signal is zero-padded at the end to
make the signal fit exactly into an integer number of window
segments, so that all of the signal is included in the output.
Defaults to <em class="xref py py-obj">True</em>. Padding occurs after boundary extension, if
<em class="xref py py-obj">boundary</em> is not <em class="xref py py-obj">None</em>, and <em class="xref py py-obj">padded</em> is <em class="xref py py-obj">True</em>, as is the
default.</p>
</div></blockquote>
<p><strong>axis</strong> : int, optional</p>
<blockquote>
<div><p>Axis along which the STFT is computed; the default is over the
last axis (i.e. <code class="docutils literal"><span class="pre">axis=-1</span></code>).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>f</strong> : ndarray</p>
<blockquote>
<div><p>Array of sample frequencies.</p>
</div></blockquote>
<p><strong>t</strong> : ndarray</p>
<blockquote>
<div><p>Array of segment times.</p>
</div></blockquote>
<p><strong>Zxx</strong> : ndarray</p>
<blockquote class="last">
<div><p>STFT of <em class="xref py py-obj">x</em>. By default, the last axis of <em class="xref py py-obj">Zxx</em> corresponds
to the segment times.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="scipy.signal.istft.html#scipy.signal.istft" title="scipy.signal.istft"><code class="xref py py-obj docutils literal"><span class="pre">istft</span></code></a></dt>
<dd>Inverse Short Time Fourier Transform</dd>
<dt><a class="reference internal" href="scipy.signal.check_COLA.html#scipy.signal.check_COLA" title="scipy.signal.check_COLA"><code class="xref py py-obj docutils literal"><span class="pre">check_COLA</span></code></a></dt>
<dd>Check whether the Constant OverLap Add (COLA) constraint is met</dd>
<dt><a class="reference internal" href="scipy.signal.welch.html#scipy.signal.welch" title="scipy.signal.welch"><code class="xref py py-obj docutils literal"><span class="pre">welch</span></code></a></dt>
<dd>Power spectral density by Welch’s method.</dd>
<dt><a class="reference internal" href="scipy.signal.spectrogram.html#scipy.signal.spectrogram" title="scipy.signal.spectrogram"><code class="xref py py-obj docutils literal"><span class="pre">spectrogram</span></code></a></dt>
<dd>Spectrogram by Welch’s method.</dd>
<dt><a class="reference internal" href="scipy.signal.csd.html#scipy.signal.csd" title="scipy.signal.csd"><code class="xref py py-obj docutils literal"><span class="pre">csd</span></code></a></dt>
<dd>Cross spectral density by Welch’s method.</dd>
<dt><a class="reference internal" href="scipy.signal.lombscargle.html#scipy.signal.lombscargle" title="scipy.signal.lombscargle"><code class="xref py py-obj docutils literal"><span class="pre">lombscargle</span></code></a></dt>
<dd>Lomb-Scargle periodogram for unevenly sampled data</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>In order to enable inversion of an STFT via the inverse STFT in
<a class="reference internal" href="scipy.signal.istft.html#scipy.signal.istft" title="scipy.signal.istft"><code class="xref py py-obj docutils literal"><span class="pre">istft</span></code></a>, the signal windowing must obey the constraint of “Constant
OverLap Add” (COLA), and the input signal must have complete
windowing coverage (i.e. <code class="docutils literal"><span class="pre">(x.shape[axis]</span> <span class="pre">-</span> <span class="pre">nperseg)</span> <span class="pre">%</span>
<span class="pre">(nperseg-noverlap)</span> <span class="pre">==</span> <span class="pre">0</span></code>). The <em class="xref py py-obj">padded</em> argument may be used to
accomplish this.</p>
<p>The COLA constraint ensures that every point in the input data is
equally weighted, thereby avoiding aliasing and allowing full
reconstruction. Whether a choice of <em class="xref py py-obj">window</em>, <em class="xref py py-obj">nperseg</em>, and
<em class="xref py py-obj">noverlap</em> satisfy this constraint can be tested with
<a class="reference internal" href="scipy.signal.check_COLA.html#scipy.signal.check_COLA" title="scipy.signal.check_COLA"><code class="xref py py-obj docutils literal"><span class="pre">check_COLA</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.19.0.</span></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r298" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R298]</a></td><td>Oppenheim, Alan V., Ronald W. Schafer, John R. Buck
“Discrete-Time Signal Processing”, Prentice Hall, 1999.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r299" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[R299]</a></td><td>Daniel W. Griffin, Jae S. Limdt “Signal Estimation from
Modified Short Fourier Transform”, IEEE 1984,
10.1109/TASSP.1984.1164317</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>Generate a test signal, a 2 Vrms sine wave whose frequency is slowly
modulated around 3kHz, corrupted by white noise of exponentially
decreasing magnitude sampled at 10 kHz.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="mf">10e3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise_power</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="mi">500</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.25</span><span class="o">*</span><span class="n">time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">carrier</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">3e3</span><span class="o">*</span><span class="n">time</span> <span class="o">+</span> <span class="n">mod</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">noise_power</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">size</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">carrier</span> <span class="o">+</span> <span class="n">noise</span>
</pre></div>
</div>
<p>Compute and plot the STFT’s magnitude.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Zxx</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Zxx</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">amp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;STFT Magnitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [sec]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure">
<img alt="../_images/scipy-signal-stft-1.png" src="../_images/scipy-signal-stft-1.png" />
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2016, The Scipy community.
      </li>
      <li>
      Last updated on Sep 20, 2017.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>