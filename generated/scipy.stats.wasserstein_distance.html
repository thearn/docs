<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.stats.wasserstein_distance &mdash; SciPy v1.1.0.dev0+04759f9 Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.0.dev0+04759f9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.1.0.dev0+04759f9 Reference Guide" href="../index.html" >
    <link rel="up" title="Statistical functions (scipy.stats)" href="../stats.html" >
    <link rel="next" title="scipy.stats.energy_distance" href="scipy.stats.energy_distance.html" >
    <link rel="prev" title="scipy.stats.entropy" href="scipy.stats.entropy.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SciPy v1.1.0.dev0+04759f9 Reference Guide</a></li>
	
          <li class="active"><a href="../stats.html" accesskey="U">Statistical functions (<code class="docutils literal"><span class="pre">scipy.stats</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.stats.energy_distance.html" title="scipy.stats.energy_distance"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.stats.entropy.html" title="scipy.stats.entropy"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo">
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.stats.entropy.html"
                        title="previous chapter">scipy.stats.entropy</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.stats.energy_distance.html"
                        title="next chapter">scipy.stats.energy_distance</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-stats-wasserstein-distance">
<h1>scipy.stats.wasserstein_distance<a class="headerlink" href="#scipy-stats-wasserstein-distance" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.stats.wasserstein_distance">
<code class="descclassname">scipy.stats.</code><code class="descname">wasserstein_distance</code><span class="sig-paren">(</span><em>u_values</em>, <em>v_values</em>, <em>u_weights=None</em>, <em>v_weights=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/04759f9/scipy/stats/stats.py#L5248-L5321"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.stats.wasserstein_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the first Wasserstein distance between two 1D distributions.</p>
<p>This distance is also known as the earth mover’s distance, since it can be
seen as the minimum amount of “work” required to transform <span class="math">\(u\)</span> into
<span class="math">\(v\)</span>, where “work” is measured as the amount of distribution weight
that must be moved, multiplied by the distance it has to be moved.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.0.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>u_values, v_values</strong> : array_like</p>
<blockquote>
<div><p>Values observed in the (empirical) distribution.</p>
</div></blockquote>
<p><strong>u_weights, v_weights</strong> : array_like, optional</p>
<blockquote>
<div><p>Weight for each value. If unspecified, each value is assigned the same
weight.
<em class="xref py py-obj">u_weights</em> (resp. <em class="xref py py-obj">v_weights</em>) must have the same length as
<em class="xref py py-obj">u_values</em> (resp. <em class="xref py py-obj">v_values</em>). If the weight sum differs from 1, it
must still be positive and finite so that the weights can be normalized
to sum to 1.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>distance</strong> : float</p>
<blockquote class="last">
<div><p>The computed distance between the distributions.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The first Wasserstein distance between the distributions <span class="math">\(u\)</span> and
<span class="math">\(v\)</span> is:</p>
<div class="math">
\[l_1 (u, v) = \inf_{\pi \in \Gamma (u, v)} \int_{\mathbb{R} \times
\mathbb{R}} |x-y| \mathrm{d} \pi (x, y)\]</div>
<p>where <span class="math">\(\Gamma (u, v)\)</span> is the set of (probability) distributions on
<span class="math">\(\mathbb{R} \times \mathbb{R}\)</span> whose marginals are <span class="math">\(u\)</span> and
<span class="math">\(v\)</span> on the first and second factors respectively.</p>
<p>If <span class="math">\(U\)</span> and <span class="math">\(V\)</span> are the respective CDFs of <span class="math">\(u\)</span> and
<span class="math">\(v\)</span>, this distance also equals to:</p>
<div class="math">
\[l_1(u, v) = \int_{-\infty}^{+\infty} |U-V|\]</div>
<p>See <a class="reference internal" href="#r678" id="id1">[R678]</a> for a proof of the equivalence of both definitions.</p>
<p>The input distributions can be empirical, therefore coming from samples
whose values are effectively inputs of the function, or they can be seen as
generalized functions, in which case they are weighted sums of Dirac delta
functions located at the specified values.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r677" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[R677]</a></td><td>“Wasserstein metric”, <a class="reference external" href="http://en.wikipedia.org/wiki/Wasserstein_metric">http://en.wikipedia.org/wiki/Wasserstein_metric</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r678" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R678]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id3">2</a>)</em> Ramdas, Garcia, Cuturi “On Wasserstein Two Sample Testing and Related
Families of Nonparametric Tests” (2015). <a class="reference external" href="https://arxiv.org/abs/1509.02237">arXiv:1509.02237</a>.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">wasserstein_distance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wasserstein_distance</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="go">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wasserstein_distance</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wasserstein_distance</span><span class="p">([</span><span class="mf">3.4</span><span class="p">,</span> <span class="mf">3.9</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">7.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
<span class="go">4.0781331438047861</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2016, The Scipy community.
      </li>
      <li>
      Last updated on Sep 20, 2017.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>